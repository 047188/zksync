import {ethers} from "ethers";
import {deployContract} from "ethereum-waffle";

const provider = new ethers.providers.JsonRpcProvider(process.env.WEB3_URL);
const wallet = ethers.Wallet.fromMnemonic(process.env.MNEMONIC, "m/44'/60'/0'/0/1").connect(provider);


async function main() {
    const verifierContractCode = require('../build/ConcreteVerifier.json');
    let verifier = await deployContract(wallet, verifierContractCode, [], {
        gasLimit: 3000000,
    });
    console.log("contract deployed: ", verifier.address);

    const pubInput = ["9366919236262480046626087110386428225440480409139203903479219191712040973482"];
    const serProof = ["4934250949535268430092530517250034144688855003728471623081612444699220355079","5100956679220776569085889666961752182164922604414739407745419585445028476222","7832176732467857667393190214847843171259421063364939528666778396551077622753","7215440588644584749782594917216216178515500541730601341117551976925913593427","10280499200207030502987158982643391987831946158500541661269659931677008030893","17157233246495488827758140634254360456372250899201517343745761768634506512553","12934196931266320861222953051568332201120592669192531204493314094357485994581","907705324491009029084855915836782283360628937207329043068585753094552434103","20750422657677867715811401437494612133272058751374405591495936718146502412072","17490174316938188080966071358745599383245679212769485042375078287270921489388","1138733652783825008030679767455624775212357728563245956552814965728863961007","395711598564772269414834325511467825573535853444490200148983478042458666489","9365693928570361104021844573719266020969440133486349100161177977502629582243","6092524716538526855876673204505628772927321625641643077939996625177904080206","265094318051392314833276510184842240030891577163990147488097746064756432684","6649657079295174136064204405514170260452269453307067576364126968337648706001","9238869159993027427435432378001875217691637994377819292827406899190482096022","1041909470017129365997291480017937412396607726048873686784328838577954620494","1490116469769215653082478751568602241906252969965393279559468041305596387231","6332992345050048721774386554498085980293310071333350200722279164020310336137","11424596968403307392654765304045598818272492156120177018552118779926432878519","7828048278416181096676652275321107227759080095847586384113733787644782627871","12764266907837734588692319351987614604453557487661151216958916220533074701281","5823691018276295329330794083866376414648611189487761714122113283182993802390","3342866812004193274186849046159497964369558084458991298623450795584142068643","3591816054190882640290309134274743628569280159970140751314871365774138281755","12596381079819199519076020877371085962560094905290267777508510027721847859741","17270405428196086010820441907308732702068622462025410523865432915797878409864","1730543355912353247862408192114578768632983520001960452694931323716614687109","6929840458716774045684960058454308072467044287222709369536815962647419900336","9258470592761443398586596655138285763128805112631315774745008868856926015471","17662521757295319926574058361781652983683951106702259417683346685595518194612","17099581798822429104673506932502662346269768949979324687472935034310022388432"];
    const tx = await verifier.verify(pubInput, serProof, {gasLimit: 2000000});
    console.log("tx: ", tx);
    const receipt = await tx.wait();
    console.log("receipt: ", receipt);

}

main();