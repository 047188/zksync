#!/bin/bash
set -e

DIR=$KEY_DIR/account-$ACCOUNT_TREE_DEPTH
echo "Checking keys in $DIR"
mkdir -p $DIR

rm -rf $DIR/*
mkdir -p $DIR/block-$BLOCK_SIZE_CHUNKS
mkdir -p $DIR/exodus_key

SPACE_LINK=$KEYS_SPACE_URL/account-$ACCOUNT_TREE_DEPTH

KEY_FILES="block-$BLOCK_SIZE_CHUNKS/zksync_pk.key exodus_key/zksync_exit_pk.key VerificationKey.sol"

for i in $KEY_FILES; do
    if ! [ -f $DIR/$i ]; then
        echo "Downloading file $SPACE_LINK/$i"
        axel -o $DIR/$i -a $SPACE_LINK/$i 2>&1
    fi
done
