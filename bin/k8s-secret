#!/bin/bash

# Generates a yaml kubernetes secret file with current env var configuration for production

#. .setup_env prod

kubectl create secret generic $ZKSYNC_ENV-secret --namespace $ZKSYNC_ENV --dry-run -o yaml
echo data:
grep -v '^#' $ENV_FILE | grep -v '^$' | while read -r line; do
    VAR=`sed 's/=.*//' <<< $line`
    echo -n "  $VAR: "
    uname -a | grep Darwin > /dev/null && echo -n ${!VAR} | base64 || echo -n ${!VAR} | base64 --wrap=0
    echo
done
